<nav class="navbar navbar-default navbar-top navbar-fixed-top navbar-expand-lg">
    <div class="navbar-collapse" id="navbarSupportedContent">
        <a id="logo-text" class="navbar-brand disabled" href="#">
            <img id="logo" src="/assets/img/construction-hat.png" width="80" height="80" class="d-inline-block align-top" alt="CONSTRUCTION HAT LOGO"> CONSTRUCTION MGMT
        </a>
        <ul class="navbar-nav ml-auto top-link">
            <li class="nav-item">
                <span id="navbar-user-name" class="navbar-text" id="username" key={{user.id}}>{{user.username}}</span>
            </li>
            <li class="nav-item">
                <a class="header-link nav-link" href="#">
                    <i class="fa fa-inbox" aria-hidden="true"></i> INBOX
                    <span class="badge badge-light">{{myTaskCount}}</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="header-link nav-link" href="/logout">LOG-OUT</a>
            </li>
        </ul>
    </div>
</nav>

<div class="container">
    <div id="wrapper">

        <div id="sidebar-wrapper">
            <ul class="sidebar-nav navbar-light">
                <div class="card">
                    <div class="card-block">
                        <h4 class="card-title text-center">NAVIGATION</h4>
                        <li class="nav-item">
                            <a class="header-link nav-link disabled" href="/">DASHBOARD</a>
                        </li>
                        <li class="nav-item">
                            <a class="header-link nav-link disabled" data-toggle="modal" data-target="#newIssueModal" href="#">ADD NEW ISSUE
                                <i class="fas fa-plus-circle"></i>
                            </a>
                        </li>
                        <div class="dropdown">
                            <li class="nav-item">
                                <a class="header-link nav-link disabled" href="/list">ALL ISSUES</a>
                            </li>
                        </div>
                        <li class="nav-item">
                            <a class="header-link nav-link disabled" href="#">FILTER</a>
                            <form>
                                <div class="filter-form form-group">
                                    <label for="status-label">STATUS</label>
                                    <input type="text">
                                    <label for="ID-label">PROJECT ID</label>
                                    <input type="text">
                                    <label for="Assigned-to-label">ASSIGNED TO</label>
                                    <input type="text">
                                    <button type="submit" class="btn btn-warning">SUBMIT</button>
                                </div>
                            </form>
                        </li>

                    </div>
                </div>
            </ul>
        </div>

        <div id="page-content-wrapper">
            <div class="page-content">

                <!-- sample table -->

                <div class="table-panel table-inverse">
                    <table class="table table-bordered table-inverse">
                        <thead class="thead-inverse">
                            <tr>
                                <th>
                                </th>
                                <th>Description</th>
                                <th>Status</th>
                                <th>Assigned To</th>
                                <th>Project</th>
                                <th>Date Created</th>
                                <th>Due Date</th>
                                <th>Date Closed</th>
                                <th>Attachments</th>
                                <th>Created By</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th id="id0" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc0"></td>
                                <td id="status0"></td>
                                <td id="assignTo0"></td>
                                <td id="project0"></td>
                                <td id="createAt0"></td>
                                <td id="duedate0"></td>
                                <td id="complete0"></td>
                                <td id="attachement0">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy0"></td>
                            </tr>
                            <tr>
                                <th id="id1" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc1"></td>
                                <td id="status1"></td>
                                <td id="assignTo1"></td>
                                <td id="project1"></td>
                                <td id="createAt1"></td>
                                <td id="duedate1"></td>
                                <td id="complete1"></td>
                                <td id="attachement1">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy1"></td>
                            </tr>
                            <tr>
                                <th id="id2" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc2"></td>
                                <td id="status2"></td>
                                <td id="assignTo2"></td>
                                <td id="project2"></td>
                                <td id="createAt2"></td>
                                <td id="duedate2"></td>
                                <td id="complete2"></td>
                                <td id="attachement2">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy2"></td>
                            </tr>
                            <tr>
                                <th id="id3" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc3"></td>
                                <td id="status3"></td>
                                <td id="assignTo3"></td>
                                <td id="project3"></td>
                                <td id="createAt3"></td>
                                <td id="duedate3"></td>
                                <td id="complete3"></td>
                                <td id="attachement3">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy3"></td>
                            </tr>
                            <tr>
                                <th id="id4" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc4"></td>
                                <td id="status4"></td>
                                <td id="assignTo4"></td>
                                <td id="project4"></td>
                                <td id="createAt4"></td>
                                <td id="duedate4"></td>
                                <td id="complete4"></td>
                                <td id="attachement4">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy4"></td>
                            </tr>
                            <tr>
                                <th id="id5" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc5"></td>
                                <td id="status5"></td>
                                <td id="assignTo5"></td>
                                <td id="project5"></td>
                                <td id="createAt5"></td>
                                <td id="duedate5"></td>
                                <td id="complete5"></td>
                                <td id="attachement5">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy5"></td>
                            </tr>
                            <tr>
                                <th id="id6" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc6"></td>
                                <td id="status6"></td>
                                <td id="assignTo6"></td>
                                <td id="project6"></td>
                                <td id="createAt6"></td>
                                <td id="duedate6"></td>
                                <td id="complete6"></td>
                                <td id="attachement6">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy6"></td>
                            </tr>
                            <tr>
                                <th id="id7" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc7"></td>
                                <td id="status7"></td>
                                <td id="assignTo7"></td>
                                <td id="project7"></td>
                                <td id="createAt7"></td>
                                <td id="duedate7"></td>
                                <td id="complete7"></td>
                                <td id="attachement7">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy7"></td>
                            </tr>
                            <tr>
                                <th id="id8" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc8"></td>
                                <td id="status8"></td>
                                <td id="assignTo8"></td>
                                <td id="project8"></td>
                                <td id="createAt8"></td>
                                <td id="duedate8"></td>
                                <td id="complete8"></td>
                                <td id="attachement8">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy8"></td>
                            </tr>
                            <tr>
                                <th id="id9" scope="row">
                                    <button type="submit" data-toggle="modal" data-target="#editModal" class="btn btn-warning btn-sm edit-button">Edit</button>
                                </th>
                                <td id="desc9"></td>
                                <td id="status9"></td>
                                <td id="assignTo9"></td>
                                <td id="project9"></td>
                                <td id="createAt9"></td>
                                <td id="duedate9"></td>
                                <td id="complete9"></td>
                                <td id="attachement9">
                                    <i class="fa fa-paperclip" aria-hidden="true"></i>
                                </td>
                                <td id="createdBy9"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div id="newIssueModal" class="modal fade">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ADD NEW ISSUE</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group modal-form">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="exampleFormControlSelect1">Project</label>
                                    <select class="form-control" id="project">
                                        {{#each allProjects}}
                                        <option value={{id}}>{{project_name}}</option>
                                        {{/each}}
                                        <option value="newProject">Add a new project</option>
                                    </select>
                                </div>
                                <div class="">
                                    <label for="description-label">Add New Project</label>
                                    <input type="text" id="projectName">
                                </div>
                            </div>
    
                            <div class="col-md-4">
                                <label for="description-label">Description</label>
                                <textarea id="desc" type="text"></textarea>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="exampleFormControlSelect1">Status</label>
                                    <select class="form-control" id="status">
                                        <option value="Open">Open</option>
                                        <option value="Closed">Closed</option>
                                        <option value="Not Approved">Not Approved</option>
                                        <option value="Ready to Inspect">Ready to Inspect</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="exampleFormControlSelect1">Assigned To</label>
                                    <select class="form-control" id="assignTo">
                                        {{#each allUsers}}
                                        <option value={{id}}>{{username}}</option>
                                        {{/each}}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="due-date-input" class="col-form-label">Due</label>
                                <div class="col-10">
                                    <input class="form-control" type="date" value="2011-08-19" id="due-date-input">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <form>
                                    <div class="form-group">
                                        <label for="exampleFormControlFile1">Add an Attachment</label>
                                        <input type="file" class="form-control-file" id="formControlFile1">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" id="addTask" class="btn btn-warning">Add Issue</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- "edit issue" modal -->
    <div id="editModal" class="modal fade">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">EDIT ISSUE</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group modal-form">
                            <div class="col-md-4">
                                <label for="description-label">Description</label>
                                <textarea rows="5" type="text"></textarea>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="exampleFormControlSelect1">Status</label>
                                    <select class="form-control" id="status">
                                        <option value="Open">Open</option>
                                        <option value="Closed">Closed</option>
                                        <option value="Not Approved">Not Approved</option>
                                        <option value="Ready to Inspect">Ready to Inspect</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="exampleFormControlSelect1">Assigned To</label>
                                    <select class="form-control" id="assignTo">
                                        {{#each allUsers}}
                                        <option value={{id}}>{{username}}</option>
                                        {{/each}}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="due-date-input" class="col-form-label">Due</label>
                                <div class="col-10">
                                    <input class="form-control" type="date" value="2011-08-19" id="due-date-input">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <form>
                                    <div class="form-group">
                                        <label for="exampleFormControlFile1">Add an Attachment</label>
                                        <input type="file" class="form-control-file" id="formControlFile1">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-warning">Save changes</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


</div>



<script type="text/javascript">
    $("#addTask").on("click", function () {
            $.post("/api/tasks",
                {
                    ProjectId: $("#project").val(),
                    task_description: $("#desc").val(),
                    status: $("#status").val(),
                    AssignedTo_Id: $("#assignTo").val(),
                    due_date: $("#due-date-input").val(),
                    createdBy_id: {{ user.id }}
            }
        );
    });


    $.ajax({
            url: "/api/tasks?page=1"
        }).done(function (data) {
            console.log("task counts: " + data.count)
            data.rows.map((data,i) => {
                $("#id" + i).attr("key", data.id);
                $("#desc" + i).text(data.task_description);
                $("#status" + i).text(data.status);
                $("#assignTo" + i).text(data.AssignedTo_Id);
                $("#project" + i).text(data.ProjectId);
                $("#createAt" + i).text(data.createdAt);
                $("#duedate" + i).text(data.due_date);
                $("#complete" + i).text(data.completed_date);
                $("#createdBy" + i).text(data.createdBy_id);
            })
        });
    
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>